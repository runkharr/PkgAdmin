#! /bin/sh
#
# $Id$
#
# Author: Boris Jakubith
# E-Mail: runkharr@googlemail.com
# Copyright: (c) 2011, Boris Jakubith <runkharr@googlemail.com>
# Released under GPL v2.
#
# Small wrapper script for `cgen.c´ (compiles and executes it - via the `run´-command,
# which is also compiled on demand) ...
#

PROG="${0##*/}"
PPATH="${0%/*}"; if [ -z "$PATH" ]; then PATH=.; fi

if [ ! -x "$PPATH/run" -o "$PPATH/run.c" -nt "$PPATH/run" ]; then
    cc "$PPATH/run.c" -o "$PPATH/run"
fi
if [ ! -x "$PPATH/${PROG}.bin" -o "$PPATH/${PROG}.c" -nt "$PPATH/${PROG}.bin" ]
then
    cc "$PPATH/${PROG}.c" -o "$PPATH/${PROG}.bin"
fi

exec "$PPATH/run" "$PPATH/${PROG}.bin" as "$PPATH/${PROG}" ${1+"$@"}
